# See the GPUs
nvidia-smi

# Create and activate a venv
python3 -m venv .venv
source .venv/bin/activate

# Install GPU-enabled TensorFlow (CUDA/cuDNN wheels are bundled)
python -m pip install --upgrade "tensorflow[and-cuda]"

# Verify TensorFlow sees the GPUs
python - <<'PY'
import tensorflow as tf
print("GPUs:", tf.config.list_physical_devices("GPU"))
PY


Create shard folders
for i in $(seq -w 001 100); do mkdir -p run_shard_$i; done

Run:
bash launch_multi_gpu.sh

